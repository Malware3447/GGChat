# Тестирование в браузере

## Проблема с CORS

При тестировании HTML файлов напрямую в браузере (file:// протокол) возникают CORS ошибки, так как браузер блокирует запросы к другим доменам/портам.

## Решение

### Вариант 1: Использование тестовой страницы (Рекомендуется)

1. **Запустите API сервер**:
   ```bash
   go run cmd/runner/main.go -config=./config/local.yml
   ```

2. **Запустите сервер статических файлов**:
   ```bash
   go run serve_static.go
   ```

3. **Откройте в браузере**:
   ```
   http://localhost:3000/test_browser.html
   ```

### Вариант 2: Использование основного HTML файла

1. **Запустите API сервер**:
   ```bash
   go run cmd/runner/main.go -config=./config/local.yml
   ```

2. **Запустите сервер статических файлов**:
   ```bash
   go run serve_static.go
   ```

3. **Откройте в браузере**:
   ```
   http://localhost:3000/cmd/index.html
   ```

## Что было добавлено

### 1. CORS поддержка в API
- Добавлены CORS заголовки в `internal/api/rout.go`
- Обработка OPTIONS запросов для preflight
- Разрешение запросов с любого источника (`*`)

### 2. Тестовая страница
- `test_browser.html` - упрощенная версия для тестирования API
- Прямая проверка доступности API при загрузке
- Подробные сообщения об ошибках

### 3. Сервер статических файлов
- `serve_static.go` - простой HTTP сервер для обслуживания HTML файлов
- Работает на порту 3000
- Избегает CORS проблем

## Тестирование

### Проверка API
1. Откройте `http://localhost:3000/test_browser.html`
2. Страница автоматически проверит доступность API
3. Если API недоступен, вы увидите сообщение об ошибке

### Тестирование регистрации
1. Заполните форму регистрации
2. Нажмите "Зарегистрироваться"
3. Проверьте результат в области уведомлений

### Тестирование входа
1. Заполните форму входа
2. Нажмите "Войти"
3. Проверьте результат в области уведомлений

## Отладка

### Если получаете 405 ошибку:
1. Убедитесь, что API сервер запущен с CORS поддержкой
2. Проверьте логи сервера на наличие ошибок
3. Убедитесь, что используете правильный URL (http://localhost:3000/...)

### Если получаете CORS ошибку:
1. Убедитесь, что открываете страницу через HTTP сервер (не file://)
2. Проверьте, что API сервер имеет CORS заголовки
3. Проверьте консоль браузера для подробностей ошибки

## Логи сервера

При успешных запросах вы должны видеть в логах API сервера:
```
time="..." level=info msg="Пришел запрос на регистрацию..."
time="..." level=info msg="Пользователь успешно зарегистрирован"
time="..." level=info msg="Пришел запрос на верификацию..."
time="..." level=info msg="Верификация пройдена."
```
